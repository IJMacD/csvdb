server.modules = (
    "mod_access",
    "mod_cgi",
    "mod_alias",
    "mod_accesslog",
    "mod_deflate",
    "mod_redirect",
    "mod_setenv",
    "mod_extforward",
)

server.document-root        = "/var/www/html"
server.errorlog             = "/var/log/lighttpd/error.log"
server.pid-file             = "/var/run/lighttpd.pid"
# server.username             = "www-data"
# server.groupname            = "www-data"
server.port                 = 80
server.breakagelog          = "/var/log/lighttpd/breakage.log"
server.core-files           = "disable"
server.http-parseopts       = ( "url-ctrls-reject" => "disable" ) # allow newline in query string

accesslog.filename          = "/var/log/lighttpd/access.log"
# Can't send to stdout
# accesslog.filename          = "/dev/stdout"
# Supposed to work, but doesn't (https://serverfault.com/a/1114322)
# accesslog.filename          = "/dev/fd/2"
# Equivelant
# accesslog.filename          = "/proc/self/fd/2"

extforward.forwarder = (
    "10.0.0.0/8" => "trust"
)
extforward.headers = ("X-Real-Ip")

setenv.add-environment = (
    "CSVDB_DATA_DIR" => env.CSVDB_DATA_DIR
)

index-file.names            = ( "index.html" )
url.access-deny             = ( "~", ".inc" )
mimetype.assign             = (
    ".html" => "text/html"
)

deflate.cache-dir          = "/var/cache/lighttpd/deflate/"
deflate.mimetypes          = ( "application/javascript", "text/css", "text/html", "text/plain" )
deflate.allowed-encodings  = ( "br", "gzip", "deflate" )

$HTTP["url"] =~ "/cgi-bin/" {
    cgi.assign = ( "" => "" )
}

cgi.assign     = (
    ".cgi" => ""
)